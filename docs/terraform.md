<!-- BEGIN_TF_DOCS -->

### Requirements

| Name                                                                     | Version   |
| ------------------------------------------------------------------------ | --------- |
| <a name="requirement_terraform"></a> [terraform](#requirement_terraform) | >= 1.2.0  |
| <a name="requirement_github"></a> [github](#requirement_github)          | >= 4.0.0  |
| <a name="requirement_hcloud"></a> [hcloud](#requirement_hcloud)          | >= 1.35.1 |
| <a name="requirement_local"></a> [local](#requirement_local)             | >= 2.0.0  |
| <a name="requirement_remote"></a> [remote](#requirement_remote)          | >= 0.0.23 |

### Providers

| Name                                                      | Version   |
| --------------------------------------------------------- | --------- |
| <a name="provider_github"></a> [github](#provider_github) | >= 4.0.0  |
| <a name="provider_hcloud"></a> [hcloud](#provider_hcloud) | >= 1.35.1 |
| <a name="provider_local"></a> [local](#provider_local)    | >= 2.0.0  |
| <a name="provider_null"></a> [null](#provider_null)       | n/a       |
| <a name="provider_random"></a> [random](#provider_random) | n/a       |
| <a name="provider_remote"></a> [remote](#provider_remote) | >= 0.0.23 |

### Modules

| Name                                                                          | Source         | Version |
| ----------------------------------------------------------------------------- | -------------- | ------- |
| <a name="module_agents"></a> [agents](#module_agents)                         | ./modules/host | n/a     |
| <a name="module_control_planes"></a> [control_planes](#module_control_planes) | ./modules/host | n/a     |

### Resources

| Name                                                                                                                                                          | Type        |
| ------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------- |
| [hcloud_firewall.k3s](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/firewall)                                             | resource    |
| [hcloud_load_balancer.control_plane](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/load_balancer)                         | resource    |
| [hcloud_load_balancer_network.control_plane](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/load_balancer_network)         | resource    |
| [hcloud_load_balancer_service.load_balancer_service](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/load_balancer_service) | resource    |
| [hcloud_load_balancer_target.load_balancer_target](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/load_balancer_target)    | resource    |
| [hcloud_network.k3s](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/network)                                               | resource    |
| [hcloud_network_subnet.agent](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/network_subnet)                               | resource    |
| [hcloud_network_subnet.control_plane](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/network_subnet)                       | resource    |
| [hcloud_placement_group.agent](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/placement_group)                             | resource    |
| [hcloud_placement_group.control_plane](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/placement_group)                     | resource    |
| [hcloud_ssh_key.k3s](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/ssh_key)                                               | resource    |
| [hcloud_volume.longhorn_volume](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/resources/volume)                                     | resource    |
| [local_file.kustomization_backup](https://registry.terraform.io/providers/hashicorp/local/latest/docs/resources/file)                                         | resource    |
| [local_sensitive_file.kubeconfig](https://registry.terraform.io/providers/hashicorp/local/latest/docs/resources/sensitive_file)                               | resource    |
| [null_resource.agents](https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource)                                                 | resource    |
| [null_resource.configure_longhorn_volume](https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource)                              | resource    |
| [null_resource.control_planes](https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource)                                         | resource    |
| [null_resource.destroy_traefik_loadbalancer](https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource)                           | resource    |
| [null_resource.first_control_plane](https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource)                                    | resource    |
| [null_resource.kustomization](https://registry.terraform.io/providers/hashicorp/null/latest/docs/resources/resource)                                          | resource    |
| [random_password.k3s_token](https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/password)                                          | resource    |
| [random_password.rancher_bootstrap](https://registry.terraform.io/providers/hashicorp/random/latest/docs/resources/password)                                  | resource    |
| [github_release.hetzner_ccm](https://registry.terraform.io/providers/integrations/github/latest/docs/data-sources/release)                                    | data source |
| [github_release.hetzner_csi](https://registry.terraform.io/providers/integrations/github/latest/docs/data-sources/release)                                    | data source |
| [github_release.kured](https://registry.terraform.io/providers/integrations/github/latest/docs/data-sources/release)                                          | data source |
| [hcloud_load_balancer.traefik](https://registry.terraform.io/providers/hetznercloud/hcloud/latest/docs/data-sources/load_balancer)                            | data source |
| [remote_file.kubeconfig](https://registry.terraform.io/providers/tenstad/remote/latest/docs/data-sources/file)                                                | data source |
| [remote_file.kustomization_backup](https://registry.terraform.io/providers/tenstad/remote/latest/docs/data-sources/file)                                      | data source |

### Inputs

| Name                                                                                                                                 | Description                                                                                                                                            | Type           | Default                                                        | Required |
| ------------------------------------------------------------------------------------------------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------ | -------------- | -------------------------------------------------------------- | :------: |
| <a name="input_agent_nodepools"></a> [agent_nodepools](#input_agent_nodepools)                                                       | Number of agent nodes.                                                                                                                                 | `list(any)`    | `[]`                                                           |    no    |
| <a name="input_allow_scheduling_on_control_plane"></a> [allow_scheduling_on_control_plane](#input_allow_scheduling_on_control_plane) | Whether to allow non-control-plane workloads to run on the control-plane nodes                                                                         | `bool`         | `false`                                                        |    no    |
| <a name="input_automatically_upgrade_k3s"></a> [automatically_upgrade_k3s](#input_automatically_upgrade_k3s)                         | Whether to automatically upgrade k3s based on the selected channel                                                                                     | `bool`         | `true`                                                         |    no    |
| <a name="input_base_domain"></a> [base_domain](#input_base_domain)                                                                   | Base domain of the cluster, used for reserve dns                                                                                                       | `string`       | `""`                                                           |    no    |
| <a name="input_block_icmp_ping_in"></a> [block_icmp_ping_in](#input_block_icmp_ping_in)                                              | Block ICMP ping in                                                                                                                                     | `bool`         | `false`                                                        |    no    |
| <a name="input_cluster_name"></a> [cluster_name](#input_cluster_name)                                                                | Name of the cluster                                                                                                                                    | `string`       | `"k3s"`                                                        |    no    |
| <a name="input_cni_plugin"></a> [cni_plugin](#input_cni_plugin)                                                                      | CNI plugin for k3s                                                                                                                                     | `string`       | `"flannel"`                                                    |    no    |
| <a name="input_control_plane_nodepools"></a> [control_plane_nodepools](#input_control_plane_nodepools)                               | Number of control plane nodes.                                                                                                                         | `list(any)`    | `[]`                                                           |    no    |
| <a name="input_disable_hetzner_csi"></a> [disable_hetzner_csi](#input_disable_hetzner_csi)                                           | Disable hetzner csi driver                                                                                                                             | `bool`         | `false`                                                        |    no    |
| <a name="input_disable_network_policy"></a> [disable_network_policy](#input_disable_network_policy)                                  | Disable k3s default network policy controller (default false, automatically true for calico and cilium)                                                | `bool`         | `false`                                                        |    no    |
| <a name="input_dns_servers"></a> [dns_servers](#input_dns_servers)                                                                   | IP Addresses to use for the DNS Servers, set to an empty list to use the ones provided by Hetzner                                                      | `list(string)` | <pre>[<br> "1.1.1.1",<br> " 1.0.0.1",<br> "8.8.8.8"<br>]</pre> |    no    |
| <a name="input_enable_cert_manager"></a> [enable_cert_manager](#input_enable_cert_manager)                                           | Enable cert manager                                                                                                                                    | `bool`         | `false`                                                        |    no    |
| <a name="input_enable_longhorn"></a> [enable_longhorn](#input_enable_longhorn)                                                       | Enable Longhorn                                                                                                                                        | `bool`         | `false`                                                        |    no    |
| <a name="input_enable_rancher"></a> [enable_rancher](#input_enable_rancher)                                                          | Enable rancher                                                                                                                                         | `bool`         | `false`                                                        |    no    |
| <a name="input_extra_firewall_rules"></a> [extra_firewall_rules](#input_extra_firewall_rules)                                        | Additional firewall rules to apply to the cluster                                                                                                      | `list(any)`    | `[]`                                                           |    no    |
| <a name="input_extra_packages_to_install"></a> [extra_packages_to_install](#input_extra_packages_to_install)                         | A list of additional packages to install on nodes                                                                                                      | `list(string)` | `[]`                                                           |    no    |
| <a name="input_hcloud_ssh_key_id"></a> [hcloud_ssh_key_id](#input_hcloud_ssh_key_id)                                                 | If passed, a key already registered within hetzner is used. Otherwise, a new one will be created by the module.                                        | `string`       | `null`                                                         |    no    |
| <a name="input_hcloud_token"></a> [hcloud_token](#input_hcloud_token)                                                                | Hetzner Cloud API Token                                                                                                                                | `string`       | n/a                                                            |   yes    |
| <a name="input_hetzner_ccm_version"></a> [hetzner_ccm_version](#input_hetzner_ccm_version)                                           | Version of Kubernetes Cloud Controller Manager for Hetzner Cloud                                                                                       | `string`       | `null`                                                         |    no    |
| <a name="input_hetzner_csi_version"></a> [hetzner_csi_version](#input_hetzner_csi_version)                                           | Version of Container Storage Interface driver for Hetzner Cloud                                                                                        | `string`       | `null`                                                         |    no    |
| <a name="input_initial_k3s_channel"></a> [initial_k3s_channel](#input_initial_k3s_channel)                                           | Allows you to specify an initial k3s channel                                                                                                           | `string`       | `"stable"`                                                     |    no    |
| <a name="input_kured_version"></a> [kured_version](#input_kured_version)                                                             | Version of Kured                                                                                                                                       | `string`       | `null`                                                         |    no    |
| <a name="input_load_balancer_disable_ipv6"></a> [load_balancer_disable_ipv6](#input_load_balancer_disable_ipv6)                      | Disable ipv6 for the load balancer                                                                                                                     | `bool`         | `false`                                                        |    no    |
| <a name="input_load_balancer_location"></a> [load_balancer_location](#input_load_balancer_location)                                  | Default load balancer location                                                                                                                         | `string`       | `"fsn1"`                                                       |    no    |
| <a name="input_load_balancer_type"></a> [load_balancer_type](#input_load_balancer_type)                                              | Default load balancer server type                                                                                                                      | `string`       | `"lb11"`                                                       |    no    |
| <a name="input_longhorn_fstype"></a> [longhorn_fstype](#input_longhorn_fstype)                                                       | The longhorn fstype                                                                                                                                    | `string`       | `"ext4"`                                                       |    no    |
| <a name="input_longhorn_replica_count"></a> [longhorn_replica_count](#input_longhorn_replica_count)                                  | Number of replicas per longhorn volume                                                                                                                 | `number`       | `3`                                                            |    no    |
| <a name="input_enable_metrics_server"></a> [enable_metrics_server](#input_enable_metrics_server)                                   | Whether to enable or disbale k3s mertric server                                                                                                        | `bool`         | `true`                                                         |    no    |
| <a name="input_network_region"></a> [network_region](#input_network_region)                                                          | Default region for network                                                                                                                             | `string`       | `"eu-central"`                                                 |    no    |
| <a name="input_placement_group_disable"></a> [placement_group_disable](#input_placement_group_disable)                               | Whether to disable placement groups                                                                                                                    | `bool`         | `false`                                                        |    no    |
| <a name="input_rancher_bootstrap_password"></a> [rancher_bootstrap_password](#input_rancher_bootstrap_password)                      | Rancher bootstrap password                                                                                                                             | `string`       | `""`                                                           |    no    |
| <a name="input_rancher_hostname"></a> [rancher_hostname](#input_rancher_hostname)                                                    | Enable rancher                                                                                                                                         | `string`       | `"rancher.example.com"`                                        |    no    |
| <a name="input_rancher_install_channel"></a> [rancher_install_channel](#input_rancher_install_channel)                               | Rancher install channel                                                                                                                                | `string`       | `"latest"`                                                     |    no    |
| <a name="input_rancher_registration_manifest_url"></a> [rancher_registration_manifest_url](#input_rancher_registration_manifest_url) | The url of a rancher registration manifest to apply. (see https://rancher.com/docs/rancher/v2.6/en/cluster-provisioning/registered-clusters/)          | `string`       | `""`                                                           |    no    |
| <a name="input_ssh_additional_public_keys"></a> [ssh_additional_public_keys](#input_ssh_additional_public_keys)                      | Additional SSH public Keys. Use them to grant other team members root access to your cluster nodes                                                     | `list(string)` | `[]`                                                           |    no    |
| <a name="input_ssh_port"></a> [ssh_port](#input_ssh_port)                                                                            | SSH port.                                                                                                                                              | `number`       | `22`                                                           |    no    |
| <a name="input_ssh_private_key"></a> [ssh_private_key](#input_ssh_private_key)                                                       | SSH private Key.                                                                                                                                       | `string`       | n/a                                                            |   yes    |
| <a name="input_ssh_public_key"></a> [ssh_public_key](#input_ssh_public_key)                                                          | SSH public Key.                                                                                                                                        | `string`       | n/a                                                            |   yes    |
| <a name="input_traefik_acme_email"></a> [traefik_acme_email](#input_traefik_acme_email)                                              | Email used to recieved expiration notice for certificate                                                                                               | `string`       | `false`                                                        |    no    |
| <a name="input_traefik_acme_tls"></a> [traefik_acme_tls](#input_traefik_acme_tls)                                                    | Whether to include the TLS configuration with the Traefik configuration                                                                                | `bool`         | `false`                                                        |    no    |
| <a name="input_traefik_additional_options"></a> [traefik_additional_options](#input_traefik_additional_options)                      | n/a                                                                                                                                                    | `list(string)` | `[]`                                                           |    no    |
| <a name="input_enable_traefik"></a> [enable_traefik](#input_enable_traefik)                                                       | Whether to enable or disbale k3s traefik installation                                                                                                  | `bool`         | `true`                                                         |    no    |
| <a name="input_use_cluster_name_in_node_name"></a> [use_cluster_name_in_node_name](#input_use_cluster_name_in_node_name)             | Whether to use the cluster name in the node name                                                                                                       | `bool`         | `true`                                                         |    no    |
| <a name="input_use_control_plane_lb"></a> [use_control_plane_lb](#input_use_control_plane_lb)                                        | When this is enabled, rather than the first node, all external traffic will be routed via a control-plane loadbalancer, allowing for high availability | `bool`         | `false`                                                        |    no    |
| <a name="input_enable_klipper_metal_lb"></a> [enable_klipper_metal_lb](#input_enable_klipper_metal_lb)                                                          | Use klipper load balancer                                                                                                                              | `bool`         | `false`                                                        |    no    |

### Outputs

| Name                                                                                                              | Description                                                |
| ----------------------------------------------------------------------------------------------------------------- | ---------------------------------------------------------- |
| <a name="output_agents_public_ipv4"></a> [agents_public_ipv4](#output_agents_public_ipv4)                         | The public IPv4 addresses of the agent server.             |
| <a name="output_cluster_name"></a> [cluster_name](#output_cluster_name)                                           | Shared suffix for all resources belonging to this cluster. |
| <a name="output_control_planes_public_ipv4"></a> [control_planes_public_ipv4](#output_control_planes_public_ipv4) | The public IPv4 addresses of the controlplane server.      |
| <a name="output_kubeconfig"></a> [kubeconfig](#output_kubeconfig)                                                 | Structured kubeconfig data to supply to other providers    |
| <a name="output_kubeconfig_file"></a> [kubeconfig_file](#output_kubeconfig_file)                                  | Kubeconfig file content with external IP address           |
| <a name="output_load_balancer_public_ipv4"></a> [load_balancer_public_ipv4](#output_load_balancer_public_ipv4)    | The public IPv4 address of the Hetzner load balancer       |

<!-- END_TF_DOCS -->
